(function() {
    var wt_webpushConfig = window.wt_webpushConfig || {
        serviceURL: 'jamie.c.shortest-route.com/charon',
        webpushScriptIncluded: false,
        useUserMatching: true,
        xKey: '',
        serviceWorkerScript: '',
        includeFirebaseScripts: true,
        firebaseConfig: {
            apiKey: '',
            authDomain: '',
            projectId: '',
            storageBucket: '',
            messagingSenderId: '',
            appId: '',
            measurementId: ''
        }
    };

var Crypto=Crypto||{};
Crypto.SHA256=function(){var d=function(c,d){return d>>>c|d<<32-c},l=function(c){for(var d="",a,g=7;0<=g;g--)a=c>>>4*g&15,d+=a.toString(16);return d};this.encode=function(c){c=unescape(encodeURIComponent(c+""));var v=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,
3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];c+=String.fromCharCode(128);
var g=Math.ceil((c.length/4+2)/16),n=Array(g),e;for(e=0;e<g;e++){n[e]=Array(16);for(var b=0;16>b;b++)n[e][b]=c.charCodeAt(64*e+4*b)<<24|c.charCodeAt(64*e+4*b+1)<<16|c.charCodeAt(64*e+4*b+2)<<8|c.charCodeAt(64*e+4*b+3)}n[g-1][14]=8*(c.length-1)/Math.pow(2,32);n[g-1][14]=Math.floor(n[g-1][14]);n[g-1][15]=8*(c.length-1)&4294967295;c=Array(64);for(e=0;e<g;e++){for(b=0;16>b;b++)c[b]=n[e][b];for(b=16;64>b;b++){var m=b;var h=c[b-2];h=(d(17,h)^d(19,h)^h>>>10)+c[b-7];var k=c[b-15];k=d(7,k)^d(18,k)^k>>>3;c[m]=
h+k+c[b-16]&4294967295}m=a[0];h=a[1];k=a[2];var u=a[3];var p=a[4];var q=a[5];var r=a[6];var f=a[7];for(b=0;64>b;b++){var t=f;f=p;f=d(6,f)^d(11,f)^d(25,f);t=t+f+(p&q^~p&r)+v[b]+c[b];f=m;var w=(d(2,f)^d(13,f)^d(22,f))+(m&h^m&k^h&k);f=r;r=q;q=p;p=u+t&4294967295;u=k;k=h;h=m;m=t+w&4294967295}a[0]=a[0]+m&4294967295;a[1]=a[1]+h&4294967295;a[2]=a[2]+k&4294967295;a[3]=a[3]+u&4294967295;a[4]=a[4]+p&4294967295;a[5]=a[5]+q&4294967295;a[6]=a[6]+r&4294967295;a[7]=a[7]+f&4294967295}return l(a[0])+l(a[1])+l(a[2])+
l(a[3])+l(a[4])+l(a[5])+l(a[6])+l(a[7])}};

var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,e,g){a!=Array.prototype&&a!=Object.prototype&&(a[e]=g.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(e){return $jscomp.SYMBOL_PREFIX+(e||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var e=0;return $jscomp.iteratorPrototype(function(){return e<a.length?{done:!1,value:a[e++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var e=a[Symbol.iterator];return e?e.call(a):$jscomp.arrayIterator(a)};
$jscomp.polyfill=function(a,e,g,h){if(e){g=$jscomp.global;a=a.split(".");for(h=0;h<a.length-1;h++){var b=a[h];b in g||(g[b]={});g=g[b]}a=a[a.length-1];h=g[a];e=e(h);e!=h&&null!=e&&$jscomp.defineProperty(g,a,{configurable:!0,writable:!0,value:e})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function e(){this.batch_=null}function g(c){return c instanceof b?c:new b(function(a,b){a(c)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;e.prototype.asyncExecute=function(c){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(c);return this};e.prototype.asyncExecuteBatch_=function(){var c=this;this.asyncExecuteFunction(function(){c.executeBatch_()})};var h=$jscomp.global.setTimeout;e.prototype.asyncExecuteFunction=function(c){h(c,
0)};e.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var c=this.batch_;this.batch_=[];for(var a=0;a<c.length;++a){var b=c[a];c[a]=null;try{b()}catch(l){this.asyncThrow_(l)}}}this.batch_=null};e.prototype.asyncThrow_=function(c){this.asyncExecuteFunction(function(){throw c;})};var b=function(c){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var a=this.createResolveAndReject_();try{c(a.resolve,a.reject)}catch(k){a.reject(k)}};b.prototype.createResolveAndReject_=
function(){function c(c){return function(n){b||(b=!0,c.call(a,n))}}var a=this,b=!1;return{resolve:c(this.resolveTo_),reject:c(this.reject_)}};b.prototype.resolveTo_=function(c){if(c===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(c instanceof b)this.settleSameAsPromise_(c);else{a:switch(typeof c){case "object":var a=null!=c;break a;case "function":a=!0;break a;default:a=!1}a?this.resolveToNonPromiseObj_(c):this.fulfill_(c)}};b.prototype.resolveToNonPromiseObj_=function(a){var c=
void 0;try{c=a.then}catch(k){this.reject_(k);return}"function"==typeof c?this.settleSameAsThenable_(c,a):this.fulfill_(a)};b.prototype.reject_=function(a){this.settle_(2,a)};b.prototype.fulfill_=function(a){this.settle_(1,a)};b.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};b.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
0;a<this.onSettledCallbacks_.length;++a)m.asyncExecute(this.onSettledCallbacks_[a]);this.onSettledCallbacks_=null}};var m=new e;b.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};b.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(l){c.reject(l)}};b.prototype.then=function(a,e){function c(a,b){return"function"==typeof a?function(b){try{l(a(b))}catch(r){g(r)}}:
b}var l,g,n=new b(function(a,b){l=a;g=b});this.callWhenSettled_(c(a,l),c(e,g));return n};b.prototype.catch=function(a){return this.then(void 0,a)};b.prototype.callWhenSettled_=function(a,b){function c(){switch(e.state_){case 1:a(e.result_);break;case 2:b(e.result_);break;default:throw Error("Unexpected state: "+e.state_);}}var e=this;null==this.onSettledCallbacks_?m.asyncExecute(c):this.onSettledCallbacks_.push(c)};b.resolve=g;b.reject=function(a){return new b(function(b,c){c(a)})};b.race=function(a){return new b(function(b,
c){for(var e=$jscomp.makeIterator(a),k=e.next();!k.done;k=e.next())g(k.value).callWhenSettled_(b,c)})};b.all=function(a){var c=$jscomp.makeIterator(a),e=c.next();return e.done?g([]):new b(function(a,b){function k(b){return function(c){h[b]=c;l--;0==l&&a(h)}}var h=[],l=0;do h.push(void 0),l++,g(e.value).callWhenSettled_(k(h.length-1),b),e=c.next();while(!e.done)})};return b},"es6","es3");
$jscomp.polyfill("Promise.prototype.finally",function(a){return a?a:function(a){return this.then(function(e){return Promise.resolve(a()).then(function(){return e})},function(e){return Promise.resolve(a()).then(function(){throw e;})})}},"es9","es3");
(function(a){var e=a.serviceURL||"jamie.c.shortest-route.com/charon",g=function(){function a(a){var b="";try{b=a.replace(/^ +| +$/g,"")}catch(I){}return b}var b=Math.pow(2,53)-1,p=Object.prototype.hasOwnProperty,c=function(a,d){var f=-1,c=a?a.length:0;if("number"==typeof c&&-1<c&&c<=b)for(;++f<c;)d(a[f],f,a);else for(var e in a)p.call(a,e)&&d(a[e],e,a)},e=function(a){return String(a).replace(/([ -])(?!$)/g,"$1?")},q=function(a,b){var d=null;c(a,function(f,c){d=b(d,f,c,a)});return d},g=function(a,
b){return q(a,function(a,d){return a||RegExp("\\b"+(d.pattern||e(d))+"\\b","i").exec(b)&&(d.label||d)})},h=function(a,b){var d=window.operamini||window.opera;return(d=d&&"function"===typeof d.version&&d.version())?d:q(a,function(a,d){return a||(RegExp(d+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(b)||0)[1]||null})},k=function(a,d){return q(a,function(a,b){return a||RegExp("\\b"+e(b)+"(?:\\b|\\w*\\d)","i").exec(d)&&b})},l=function(a,d){return q(a,function(a,b){var f=b.pattern||
e(b);return a||RegExp("\\b"+f+"(?:/[\\d.]+|[ \\w.]*)","i").exec(d)&&(b.label||b)})},m=function(a,b){return q(a,function(a,d){return a||(RegExp("\\b"+e(d)+"((?:/[\\d.]+|[ \\w.]*))","i").exec(b)||0)[1]||null})},n=function(a,b){return q(a,function(a,d){var f=d.pattern||e(d);return a||RegExp("\\b"+f,"i").exec(b)&&(d.label||d)})};this.parse=function(d){var b=g(["Electron","Iceweasel",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},{label:"Samsung Internet",pattern:"SamsungBrowser"},"Vivaldi",
"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"],d),f=["(?:Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Opera ?Mini|SamsungBrowser|Version)",e(b),"(?:Firefox|Minefield|NetFront)"],
c=["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","SuSE","Ubuntu","webOS","Linux","Mac OS X","Macintosh","Mac","Windows"],p=l(c,d);return{name:a(b),version:a(h(f,d)),manufacturer:a(k("Apple Google HP HTC Huawei Lenovo LG Microsoft Motorola Nintendo Nokia Samsung Sony".split(" "),d)),osName:a(p),osVersion:a(m(c,d)).replace(/_/g,"."),platform:a(n([{label:"Windows",pattern:"Windows"},{label:"MacOS",pattern:"Mac"},{label:"Linux",pattern:".+"}],p))}}},h=function(){return"undefined"!==
typeof window.firebase&&"function"===typeof window.firebase.initializeApp&&"function"===typeof window.firebase.messaging},b=function(){if(-1!==document.location.href.indexOf("mapp_debug=1")||-1!==document.cookie.indexOf("mapp_debug=1"))arguments[0]="Mapp Webpush: "+arguments[0],console.log.apply(null,arguments)},m=function(a,b){window.localStorage.setItem("mapp.intelligence."+a,b)},c=function(a){"undefined"===typeof a&&(a=(new Crypto.SHA256).encode(k().token));m("uuid",a)},n=function(a){return window.localStorage.getItem("mapp.intelligence."+
a)||""},k=function(){return{dmc:n("dmc"),uuid:n("uuid"),alias:n("alias"),token:n("token")}},l=function(){return"https://"+e+"/api/v3/web"},t=function(b,f,c){b={method:"PUT",headers:{X_KEY:a.xKey,"Content-Type":"application/json"},body:{actions:{time:Date.now()+""},key:b}};if(c)for(var d in c){var p=d+"";b.body[p]=c[p]}if(f)for(var e in f)c=e+"",b.body.actions[c]=f[c];b.body=JSON.stringify(b.body);return b},z=function(a){var d="";try{d=window.Intl.DateTimeFormat().resolvedOptions().timeZone}catch(A){}var c=
{};try{c=(new g).parse(navigator.userAgent)}catch(A){}a=t(a,{register:{appVersion:"1.0.1",clientName:c.name||"",clientVersion:c.version||"",locale:navigator.language,timeZone:d,manufacturer:c.manufacturer||"",platform:c.platform||"",resolution:screen.height+"x"+screen.width,osName:c.osName||"",osNumber:c.osVersion||"",density:Math.round(window.devicePixelRatio)+"",pushToken:""}});d=JSON.parse(JSON.stringify(a));d.body=JSON.parse(d.body);b("register new user (fetch request): <pre>"+JSON.stringify(d,
null,4)+"</pre>");return fetch(l(),a)},u=function(a){return new Promise(function(b){if(document.createElement){var d=document.getElementsByTagName("head").item(0),c=document.createElement("script");c.setAttribute("language","javascript");c.setAttribute("type","text/javascript");c.setAttribute("src",a);c.onload=function(){window.setTimeout(function(){b()},100)};d.appendChild(c)}})},x=function(a){var d=a;(new Promise(function(a,f){d.uuid&&d.dmc?(b("existing user (key): "+d.uuid),b("existing user (dmcUserId): "+
d.dmc),a(d)):(d.uuid||(c(),d=k(),b("register new user (key): "+d.uuid)),z(d.uuid).then(function(b){a(b)})["catch"](function(a){f(a)}))})).then(function(a){return"function"===typeof a.json?a.json():a}).then(function(a){b("user (response): <pre>"+JSON.stringify(a,null,4)+"</pre>");if(a.payload&&a.payload.dmcUserId){var d={action:"dmc",value:a.payload.dmcUserId};window.wtWebpushMessage=window.wtWebpushMessage||[];window.wtWebpushMessage.push(d);m("dmc",a.payload.dmcUserId);a:{d=a.payload.dmcUserId;if((a=
a.payload.register)&&"number"===typeof a.length){a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next())if(c=c.value,d!==c){d=c;break a}}d=""}m("alias",d);r(!0)}})["catch"](function(a){b("user (response error): "+a.toString())})},y=function(d){return new Promise(function(c,e){b("call firebase");firebase.initializeApp(a.firebaseConfig);navigator.serviceWorker.register(a.serviceWorkerScript).then(function(a){var f=firebase.messaging();f.useServiceWorker(a);f.requestPermission().then(function(){f.getToken().then(function(a){b("firebase token: "+
a);m("token",a);d&&d!==a?c({token:a,status:"update"}):c({token:a,status:"new"})})["catch"](function(a){e("firebase token (error): "+a.toString())})})["catch"](function(a){b("firebase request (permission): "+a.toString());c({token:"",status:"delete"})});f.onMessage(function(a){if(a&&a.notification){b("message received: <pre>"+JSON.stringify(a,null,4)+"</pre>");var d=a.notification.title;a=a.notification;a.image&&!a.icon&&(a.icon=a.image);new Notification(d,a)}})})["catch"](function(a){e("firebase register (error): "+
a.toString())})})},r=function(a){var d=k(),e={pushToken_bk:"",pushToken:""};a?e.pushToken=d.token:e.pushToken_bk=d.token;d=t(d.uuid,{set:e},{alias:d.alias});e=JSON.parse(JSON.stringify(d));e.body=JSON.parse(e.body);b("opt-in / -out (request): <pre>"+JSON.stringify(e,null,4)+"</pre>");fetch(l(),d).then(function(a){return"function"===typeof a.json?a.json():a}).then(function(a){b("opt-in / -out (response): <pre>"+JSON.stringify(a,null,4)+"</pre>")})["catch"](function(a){b("opt-in / -out (error): "+a.toString())})["finally"](function(){a||
(m("token",""),m("dmc",""),m("alias",""),c(""))})},B=function(a){return new Promise(function(d,c){var e=k();if(e.alias!==a){e=t(e.uuid,{set:{alias:a}},{oldAlias:e.alias});var f=JSON.parse(JSON.stringify(e));f.body=JSON.parse(f.body);b("alias (fetch request): <pre>"+JSON.stringify(f,null,4)+"</pre>");fetch(l(),e).then(function(a){"function"===typeof a.json?d(a.json()):d(a)})["catch"](function(a){c("alias (response error): "+a.toString())})}else return d("old and new alias are equal ("+e.alias+", "+a+
")")})},C=function(a){a&&B(a).then(function(d){try{b("alias (response): <pre>"+JSON.stringify(d,null,4)+"</pre>")}catch(p){b(d)}m("alias",a)})["catch"](function(a){b(a)})},v=function(a){a&&"object"===typeof a&&"alias"===a.action&&C(a.value)},D=function(){var a=k();y(a.token).then(function(d){"new"===d.status?x(a):"update"===d.status?r(!0):a.token&&a.token!==d.token?r(!1):b("user has already an opt-"+(d.status?"in":"out"))})["catch"](function(a){b(a)})},E=function(a){h()&&a();var b=window.setInterval(function(){h()&&
(window.clearInterval(b),a())},500)},F=function(){return new Promise(function(b){a.includeFirebaseScripts&&u("https://www.gstatic.com/firebasejs/8.9.1/firebase-app.js").then(function(){u("https://www.gstatic.com/firebasejs/8.9.1/firebase-messaging.js").then(function(){})});E(b)})},w=function(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent&&a.detachEvent("on"+b,c)},G=function(a,b,c){a.addEventListener?("webkitvisibilitychange"===b&&w(a,b,c),a.addEventListener(b,c,!1)):a.attachEvent&&
("beforeunload"!==b&&"webkitvisibilitychange"!==b||w(a,b,c),a.attachEvent("on"+b,c))},H=function(){return new Promise(function(a){"complete"===document.readyState?a():G(window,"load",function(){a()})})};(function(){"undefined"!==typeof window.Promise&&"function"===typeof window.fetch&&"undefined"!==typeof window.navigator.serviceWorker&&"undefined"!==typeof window.localStorage&&"function"===typeof window.localStorage.setItem&&"function"===typeof window.localStorage.getItem&&H().then(function(){F().then(function(){D();
for(var a=$jscomp.makeIterator(window.mappWebpushMessage||[]),b=a.next();!b.done;b=a.next())v(b.value);window.mappWebpushMessage={version:"1.0.1",length:0,push:v}})})})()})(wt_webpushConfig);

})();
